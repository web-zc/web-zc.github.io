<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>this指向</title>
      <link href="/2019/04/20/index/"/>
      <url>/2019/04/20/index/</url>
      
        <content type="html"><![CDATA[<h2 id="最近看了几篇有关this的博客总结下"><a href="#最近看了几篇有关this的博客总结下" class="headerlink" title="最近看了几篇有关this的博客总结下"></a>最近看了几篇有关this的博客总结下</h2><p><strong>前言：</strong></p><p>this指向一直令人头疼，每当自己快弄懂得时候，又来些奇怪的案例，一战回到解放前。</p><p>第一次写博客，谈一下现在对this的理解。</p><p>如果有不对的地方，欢迎大家指正。</p><h3 id="一、this指向"><a href="#一、this指向" class="headerlink" title="一、this指向"></a>一、this指向</h3><ol><li><p><strong>普通函数调用</strong>  this是全局对象window   这个函数实质是window下的方法</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">520</span><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 520</span><span class="token punctuation">}</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></li><li><p><strong>函数作为对象的方法被调用</strong>  函数的this就是调用它的对象</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span>        <span class="token punctuation">}</span>        <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        obj<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">1</span>        obj<span class="token punctuation">.</span>m <span class="token operator">=</span> test        obj<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 1</span></code></pre></li><li><p><strong>构造函数</strong>  构造函数中this是实例化的对象</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>           <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">520</span>       <span class="token punctuation">}</span>       <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>       obj<span class="token punctuation">.</span>x  <span class="token comment" spellcheck="true">//520</span></code></pre></li><li><p><strong>箭头函数</strong> 箭头函数的this是，上一作用域的this   且无法通过call方法改变this指向</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> arry <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>       <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">520</span>       <span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>          arry<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>itme <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 520</span>          <span class="token punctuation">}</span><span class="token punctuation">)</span>       <span class="token punctuation">}</span>       <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><strong>对象中箭头函数</strong> 对象中箭头函数的this指向window</p><pre class=" language-javascript"><code class="language-javascript"> <span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">520</span>      <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>          x<span class="token punctuation">:</span><span class="token number">1314</span><span class="token punctuation">,</span>          y<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 520</span>          <span class="token punctuation">}</span><span class="token punctuation">,</span>          z<span class="token punctuation">:</span> <span class="token punctuation">{</span>             x<span class="token punctuation">:</span> <span class="token number">1314</span><span class="token punctuation">,</span>             d<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>                 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 520</span>             <span class="token punctuation">}</span>          <span class="token punctuation">}</span>      <span class="token punctuation">}</span>      obj<span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 对象中箭头函数this是window</span>      obj<span class="token punctuation">.</span>z<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 多层对象嵌套中的箭头函数的this还是window</span></code></pre></li></ol><ol start="5"><li><p><strong>原型方法</strong> 原型方法中的this是实例对象</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>          <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">520</span>       <span class="token punctuation">}</span>       Test<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>test <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//520</span>       <span class="token punctuation">}</span>       <span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>       foo<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></li><li><p><strong>匿名函数</strong> 匿名函数中的this是window   匿名函数会自执行</p><pre class=" language-javascript"><code class="language-javascript"> <span class="token keyword">var</span> x <span class="token operator">=</span><span class="token number">520</span>       <span class="token keyword">function</span> <span class="token function">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>          <span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">1314</span>         <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">// 520</span>          <span class="token punctuation">}</span>       <span class="token punctuation">}</span>          <span class="token keyword">var</span> z <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>          <span class="token function">z</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><hr></li></ol><h3 id="二、改变this指向的方法"><a href="#二、改变this指向的方法" class="headerlink" title="二、改变this指向的方法"></a>二、改变this指向的方法</h3><ul><li><p>call、apply、bind都属于Function.prototype的一个方法，所以每个function实例都有call、apply、bind属性</p><pre class=" language-javascript"><code class="language-javascript"> <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>         b<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">{</span>             console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>             console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>         <span class="token punctuation">}</span>     <span class="token punctuation">}</span>     <span class="token comment" spellcheck="true">//以下所有调用都可以传递参数</span>     obj<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//obj</span>     obj<span class="token punctuation">.</span>b<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// window call与apply 都会返回新函数</span>     obj<span class="token punctuation">.</span>b<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// window</span>     obj<span class="token punctuation">.</span>b<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// window bind返回改变了上下文后的一个函数，要执行，还要调用</span></code></pre></li><li><p>用变量或对象下的方法接收，会改变this指向</p><pre class=" language-javascript"><code class="language-javascript"> <span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">1314</span>        <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>            x<span class="token punctuation">:</span> <span class="token number">520</span><span class="token punctuation">,</span>            b<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token punctuation">{</span>            x<span class="token punctuation">:</span> <span class="token number">666</span>        <span class="token punctuation">}</span>        obj<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">//520  </span>        <span class="token keyword">var</span> q <span class="token operator">=</span> obj<span class="token punctuation">.</span>b  <span class="token comment" spellcheck="true">//用普通变量接收，this是window</span>        <span class="token function">q</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 1314</span>        c<span class="token punctuation">.</span>o <span class="token operator">=</span> obj<span class="token punctuation">.</span>b    <span class="token comment" spellcheck="true">//用对象下的一个方法接收this是该对象c</span>        c<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 666</span></code></pre></li></ul>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
