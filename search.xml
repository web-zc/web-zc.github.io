<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>CSS</title>
      <link href="/2019/04/29/css/"/>
      <url>/2019/04/29/css/</url>
      
        <content type="html"><![CDATA[<h2 id="CSS有所感"><a href="#CSS有所感" class="headerlink" title="CSS有所感"></a>CSS有所感</h2><p>文档流 单独 block inline</p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>this指向</title>
      <link href="/2019/04/20/index/"/>
      <url>/2019/04/20/index/</url>
      
        <content type="html"><![CDATA[<h2 id="最近看了几篇有关this的博客总结下"><a href="#最近看了几篇有关this的博客总结下" class="headerlink" title="最近看了几篇有关this的博客总结下"></a>最近看了几篇有关this的博客总结下</h2><p><strong>前言：</strong></p><p>this指向一向令人头疼，每当自己快弄懂得时候，又来些奇怪的案例，一战回到解放前。</p><p>第一次写博客，谈一下现在对this的理解。</p><p>如果有不对的地方，欢迎大家指正。</p><h3 id="一、this指向"><a href="#一、this指向" class="headerlink" title="一、this指向"></a>一、this指向</h3><ol><li><p><strong>普通函数调用</strong>  this是全局对象window   这个函数实质是window下的方法</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">520</span><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 520</span><span class="token punctuation">}</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></li><li><p><strong>函数作为对象的方法被调用</strong>  函数的this就是调用它的对象</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span>        <span class="token punctuation">}</span>        <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        obj<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">1</span>        obj<span class="token punctuation">.</span>m <span class="token operator">=</span> test        obj<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 1</span></code></pre></li><li><p><strong>构造函数</strong>  构造函数中this是实例化的对象</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>           <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">520</span>       <span class="token punctuation">}</span>       <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>       obj<span class="token punctuation">.</span>x  <span class="token comment" spellcheck="true">//520</span></code></pre></li><li><p><strong>箭头函数</strong> 箭头函数的this是，上一作用域的this   且无法通过call等方法改变this指向</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> arry <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>       <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">520</span>       <span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>          arry<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>itme <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 520</span>          <span class="token punctuation">}</span><span class="token punctuation">)</span>       <span class="token punctuation">}</span>       <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><strong>对象中箭头函数</strong> 对象中箭头函数的this指向window</p><pre class=" language-javascript"><code class="language-javascript"> <span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">520</span>      <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>          x<span class="token punctuation">:</span><span class="token number">1314</span><span class="token punctuation">,</span>          y<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 520</span>          <span class="token punctuation">}</span><span class="token punctuation">,</span>          z<span class="token punctuation">:</span> <span class="token punctuation">{</span>             x<span class="token punctuation">:</span> <span class="token number">1314</span><span class="token punctuation">,</span>             d<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>                 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 520</span>             <span class="token punctuation">}</span>          <span class="token punctuation">}</span>      <span class="token punctuation">}</span>      obj<span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 对象中箭头函数this是window</span>      obj<span class="token punctuation">.</span>z<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 多层对象嵌套中的箭头函数的this还是window</span></code></pre></li></ol><ol start="5"><li><p><strong>原型方法</strong> 原型方法中的this是实例对象</p><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>          <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">520</span>       <span class="token punctuation">}</span>       Test<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>test <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//520</span>       <span class="token punctuation">}</span>       <span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>       foo<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></li><li><p><strong>匿名函数</strong> 匿名函数中的this是window   匿名函数会自执行</p><pre class=" language-javascript"><code class="language-javascript"> <span class="token keyword">var</span> x <span class="token operator">=</span><span class="token number">520</span>       <span class="token keyword">function</span> <span class="token function">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>          <span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">1314</span>         <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">// 520</span>          <span class="token punctuation">}</span>       <span class="token punctuation">}</span>          <span class="token keyword">var</span> z <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>          <span class="token function">z</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></li><li><strong>事件处理函数</strong> 事件处理函数的this 指向 绑定事件的对象<pre class=" language-javascript"><code class="language-javascript"> <span class="token keyword">var</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"btn"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> btn<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// btnDOM对象</span> <span class="token punctuation">}</span></code></pre></li><li><strong>定时器中的回调函数</strong> 定时器函数中的 this 指向 window<pre class=" language-javascript"><code class="language-javascript"> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// window</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span></code></pre></li></ol><hr><h3 id="二、改变this指向的方法"><a href="#二、改变this指向的方法" class="headerlink" title="二、改变this指向的方法"></a>二、改变this指向的方法</h3><ul><li>call、apply、bind都属于Function.prototype的一个方法，所以每个function实例都有call、apply、bind属性</li><li>函数调用bind()后返回一个新的函数（称为绑定函数），与被调用函数有相同的函数体，只是this改变了</li></ul><pre class=" language-javascript"><code class="language-javascript">   <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>           b<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">{</span>               console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>               console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>           <span class="token punctuation">}</span>       <span class="token punctuation">}</span>       <span class="token comment" spellcheck="true">//以下所有调用都可以传递参数</span>       obj<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//obj</span>       obj<span class="token punctuation">.</span>b<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// window call与apply 都会返回新函数</span>       obj<span class="token punctuation">.</span>b<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// window</span>       obj<span class="token punctuation">.</span>b<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// window bind返回改变了上下文后的一个函数，要执行的话还要调用</span></code></pre><ul><li><p>用变量或对象下的方法接收，会改变this指向</p><pre class=" language-javascript"><code class="language-javascript"> <span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">1314</span>        <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>            x<span class="token punctuation">:</span> <span class="token number">520</span><span class="token punctuation">,</span>            b<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token punctuation">{</span>            x<span class="token punctuation">:</span> <span class="token number">666</span>        <span class="token punctuation">}</span>        obj<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">//520  </span>        <span class="token keyword">var</span> q <span class="token operator">=</span> obj<span class="token punctuation">.</span>b  <span class="token comment" spellcheck="true">//用普通变量接收，this是window</span>        <span class="token function">q</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 1314</span>        c<span class="token punctuation">.</span>o <span class="token operator">=</span> obj<span class="token punctuation">.</span>b    <span class="token comment" spellcheck="true">//用对象下的一个方法接收this是该对象c</span>        c<span class="token punctuation">.</span><span class="token function">o</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 666</span></code></pre></li><li>一个函数调用bind返回的新函数, 调用bind不会改变this指向了<pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> o <span class="token operator">=</span>  z<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>  o<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// this是obj</span></code></pre></li><li>箭头函数的this无法通过 call、apply、bind改变<pre class=" language-javascript"><code class="language-javascript">  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">123</span>        <span class="token keyword">var</span> obj <span class="token operator">=</span><span class="token punctuation">{</span>           a<span class="token punctuation">:</span><span class="token number">520</span>       <span class="token punctuation">}</span>       <span class="token keyword">var</span> z <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>           console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>       <span class="token punctuation">}</span>       z<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 123</span></code></pre><h3 id="三、其他参考"><a href="#三、其他参考" class="headerlink" title="三、其他参考"></a>三、其他参考</h3>   this 是 JS 中的动态作用域机制, 具体来说有四种, 优先级有低到高分别如下:</li></ul><ol><li><p>默认的 this 绑定, 就是说 在一个函数中使用了 this, 但是没有为 this 绑定对象. 这种情况下, 非严格默认, this 就是全局变量 Node 环境中的 global, 浏览器环境中的 window.</p></li><li><p>隐式绑定: 使用 obj.foo() 这样的语法来调用函数的时候, 函数 foo 中的 this 绑定到 obj 对象.</p></li><li><p>显示绑定: foo.call(obj, …), foo.apply(obj,[…]), foo.bind(obj,…)</p></li><li><p>构造绑定: new foo() , 这种情况, 无论 foo 是否做了绑定, 都要创建一个新的对象, 然后 foo 中的 this 引用这个对象.<br>严格模式下，默认的this就是undefined了</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
